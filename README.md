# Predicting A Galaxy's Rotation Curve Using a Convolutional Neural Network

## Abstract
The extraction of rotation curves from observed galaxies offers a deep insight into the
observed mass from a galaxy and which percentage of that mass can be attributed to
dark matter. In this paper we propose a new method of obtaining kinematic models
from data obtained through 21cm spin-flip transitions of neutral hydrogen. This new
approach will offer a new and robust method of analyzing simulated galaxies through
a deep-learning algorithm. In developing this machine learning algorithm, a simulated
idealized dataset obtained through the FIRE database, was used with varying
inclination angles to train the neural network. Leveraging the imaging processing capabilities
found in 3D Convolutional Neural Networks (CNNs), the algorithm is able
to recognize patterns of galaxy evolution in 3-dimensional space to derive rotation
curves. With the designed workflow, the trained CNN was able to predict the trends
found in the rotation curve derived from the WALLABY survey using the 3D Barolo
algorithm. This new approach can greatly maximize the accuracy and reliability of
rotation curves derived from observational data to provide a deeper understanding of
the evolution of galaxies.

## Getting Started 
### Prerequistes
To ensure you have all the software needed, you must install the following packages: 
- [ ] numpy
- [ ] scipy
- [ ] matplotlib
- [ ] astropy
- [ ] SpectralCube
- [ ] tensorflow

Along with the packages, you must ensure that you have the FIRE data files of the simulated galaxies
in a single folder. 

## Usage
This code is simply used to train a neural network on the prediction of rotation curves, and implementation file
must be created in order to test and use the dataset generated by the user. 
The code is broken up into several sections to ensure the dataset is correctly formatted and the nessecary
data is extracted from the dataset. The Find_Curve.py file is the framework to extract the data for the
neural network by using the "Tilted-ring model" to fit the parameters of the simulation. The data extracted is then
used in the GenerateDataset.py file which generates all the needed data for obtaining the rotation curves. 
The GetRotationCurve.py file is to obtain the important features, obtain the rotation curves and save them for 
training the network later on. The Neural_Network.py file is the framework of the neural network used for training, where 
in our case we used a simple 3D-Convolutional neural network. The last file used is TrainModel.py, where all the data collected 
from the files is used to train the neural network. 
